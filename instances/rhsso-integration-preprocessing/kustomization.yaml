apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - rbac.yaml
  - secretstore.yaml
  - sso-configs-es.yaml
  - keycloak-pre-processing-job.yaml

patches:
- target:
    group: external-secrets.io
    kind: SecretStore
    labelSelector: "sso-integration-component=preprocessing-secretstore"
  patch: |-
    - op: replace
      path: /spec/provider/vault/caBundle
      value: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZNekNDQk5tZ0F3SUJBZ0lRQkZOeGRLYURzaTV6R25sa1ZoZFA2ekFLQmdncWhrak9QUVFEQWpCS01Rc3cKQ1FZRFZRUUdFd0pWVXpFWk1CY0dBMVVFQ2hNUVEyeHZkV1JtYkdGeVpTd2dTVzVqTGpFZ01CNEdBMVVFQXhNWApRMnh2ZFdSbWJHRnlaU0JKYm1NZ1JVTkRJRU5CTFRNd0hoY05Nakl3TWpFMU1EQXdNREF3V2hjTk1qTXdNakUxCk1qTTFPVFU1V2pCMU1Rc3dDUVlEVlFRR0V3SlZVekVUTUJFR0ExVUVDQk1LUTJGc2FXWnZjbTVwWVRFV01CUUcKQTFVRUJ4TU5VMkZ1SUVaeVlXNWphWE5qYnpFWk1CY0dBMVVFQ2hNUVEyeHZkV1JtYkdGeVpTd2dTVzVqTGpFZQpNQndHQTFVRUF4TVZjMjVwTG1Oc2IzVmtabXhoY21WemMyd3VZMjl0TUZrd0V3WUhLb1pJemowQ0FRWUlLb1pJCnpqMERBUWNEUWdBRTJITjNqWEg0QTlvVHBBVkdEeHNyS01TZjMwcE9xeHBSWUlWTVQxcHZCQXFMUXJXdTVnWVIKWUttTGlqdXZVTVNxZVIvcUhjQlZJWFBwcFBJaXI0dHM3S09DQTNRd2dnTndNQjhHQTFVZEl3UVlNQmFBRktYTwpOK3Jyc0hVT2xHZUl0RVg2MlNRUWg1WWZNQjBHQTFVZERnUVdCQlMyeVJZSm9oOFFFcnZXY0RBaUlyQ0RMUlBvCmVEQTZCZ05WSFJFRU16QXhnZ3dxTG5OM2FXNXVaWGt1YVcrQ0ZYTnVhUzVqYkc5MVpHWnNZWEpsYzNOc0xtTnYKYllJS2MzZHBibTVsZVM1cGJ6QU9CZ05WSFE4QkFmOEVCQU1DQjRBd0hRWURWUjBsQkJZd0ZBWUlLd1lCQlFVSApBd0VHQ0NzR0FRVUZCd01DTUhzR0ExVWRId1IwTUhJd042QTFvRE9HTVdoMGRIQTZMeTlqY213ekxtUnBaMmxqClpYSjBMbU52YlM5RGJHOTFaR1pzWVhKbFNXNWpSVU5EUTBFdE15NWpjbXd3TjZBMW9ET0dNV2gwZEhBNkx5OWoKY213MExtUnBaMmxqWlhKMExtTnZiUzlEYkc5MVpHWnNZWEpsU1c1alJVTkRRMEV0TXk1amNtd3dQZ1lEVlIwZwpCRGN3TlRBekJnWm5nUXdCQWdJd0tUQW5CZ2dyQmdFRkJRY0NBUlliYUhSMGNEb3ZMM2QzZHk1a2FXZHBZMlZ5CmRDNWpiMjB2UTFCVE1IWUdDQ3NHQVFVRkJ3RUJCR293YURBa0JnZ3JCZ0VGQlFjd0FZWVlhSFIwY0RvdkwyOWoKYzNBdVpHbG5hV05sY25RdVkyOXRNRUFHQ0NzR0FRVUZCekFDaGpSb2RIUndPaTh2WTJGalpYSjBjeTVrYVdkcApZMlZ5ZEM1amIyMHZRMnh2ZFdSbWJHRnlaVWx1WTBWRFEwTkJMVE11WTNKME1Bd0dBMVVkRXdFQi93UUNNQUF3CmdnRitCZ29yQmdFRUFkWjVBZ1FDQklJQmJnU0NBV29CYUFCM0FPZyswTm8rOVFZMU11ZFhLTHlKYThrRDA4dlIKRVd2czYybmhkMzF0QnIxdUFBQUJmdndWSkZzQUFBUURBRWd3UmdJaEFNak54dTlzeUdsdS8ra0docWtmVGZnWQptakh5M1doZ3JZL0NQaHdYM1BZeUFpRUE0dUgyNENndUg3NnQ0RmsyL1RiZ3hzczR3ZktySGhiRFFZdWx2S3VrClpub0FkUUExenhrYnY3RnNWNzhQclV4dFFzdTd0aWNnSmxIcVArRXE3NmdEd3p2V1RBQUFBWDc4RlNTSUFBQUUKQXdCR01FUUNJQVBGR2dYVGZTUFhSM0ZJQWExZ0ZrUlA1NzBCOUNia1R2dGc1UlY2aTlRSEFpQnBvL0RBZTQ2QwpjVWE3TGZic3dXaHN4emcxRnJzeXVSaHMzWlR0Tmg4QnlRQjJBTE56ZHdmaGhGRDRZNGJXQmFuY0VRbEtlUzJ4Clp3d0xoOXp3QXc1NU5xV2FBQUFCZnZ3VkpLY0FBQVFEQUVjd1JRSWhBTmpMZlpCVjhtanNOMkFlV2IyMER5SGgKQUlsZ0J3K29wYnJ1c0dUVHZWQXZBaUI1ZWdRWWxZaVZHWGpobkdhak5LcFFScXcwWUxhd1gzSkdkdUx0aW1YQgovREFLQmdncWhrak9QUVFEQWdOSUFEQkZBaUE1aDlhMDZDVFB2RnpBZWpUMmlOZStlNHJnd2dWa2k1cDFic1BpClZocFBwQUloQVBURVJvTVZqY053NW9RR2ZCaXYvVFozeThPQXdRMGRGV3gvS3kvaGdDZVgKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQotLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJRHpUQ0NBcldnQXdJQkFnSVFDamVIWkY1ZnRJd2lUdjBiN1JRTVBEQU5CZ2txaGtpRzl3MEJBUXNGQURCYQpNUXN3Q1FZRFZRUUdFd0pKUlRFU01CQUdBMVVFQ2hNSlFtRnNkR2x0YjNKbE1STXdFUVlEVlFRTEV3cERlV0psCmNsUnlkWE4wTVNJd0lBWURWUVFERXhsQ1lXeDBhVzF2Y21VZ1EzbGlaWEpVY25WemRDQlNiMjkwTUI0WERUSXcKTURFeU56RXlORGd3T0ZvWERUSTBNVEl6TVRJek5UazFPVm93U2pFTE1Ba0dBMVVFQmhNQ1ZWTXhHVEFYQmdOVgpCQW9URUVOc2IzVmtabXhoY21Vc0lFbHVZeTR4SURBZUJnTlZCQU1URjBOc2IzVmtabXhoY21VZ1NXNWpJRVZEClF5QkRRUzB6TUZrd0V3WUhLb1pJemowQ0FRWUlLb1pJemowREFRY0RRZ0FFdWExTlpwa1VDMGJzSDRIUktsQWUKblFNVkx6UVNmUzJXdUlnNG00VmZqNys3VGU5aFJzVEpjOVFrVCtEdUhNNXNzMUZ4TDJydVRBVUpkOU55WXFTYgoxNk9DQVdnd2dnRmtNQjBHQTFVZERnUVdCQlNsempmcTY3QjFEcFJuaUxSRit0a2tFSWVXSHpBZkJnTlZIU01FCkdEQVdnQlRsblZrd2drZFl6S3o2Q0ZRMmhuczZ0UVJOOERBT0JnTlZIUThCQWY4RUJBTUNBWVl3SFFZRFZSMGwKQkJZd0ZBWUlLd1lCQlFVSEF3RUdDQ3NHQVFVRkJ3TUNNQklHQTFVZEV3RUIvd1FJTUFZQkFmOENBUUF3TkFZSQpLd1lCQlFVSEFRRUVLREFtTUNRR0NDc0dBUVVGQnpBQmhoaG9kSFJ3T2k4dmIyTnpjQzVrYVdkcFkyVnlkQzVqCmIyMHdPZ1lEVlIwZkJETXdNVEF2b0MyZ0s0WXBhSFIwY0RvdkwyTnliRE11WkdsbmFXTmxjblF1WTI5dEwwOXQKYm1seWIyOTBNakF5TlM1amNtd3diUVlEVlIwZ0JHWXdaREEzQmdsZ2hrZ0JodjFzQVFFd0tqQW9CZ2dyQmdFRgpCUWNDQVJZY2FIUjBjSE02THk5M2QzY3VaR2xuYVdObGNuUXVZMjl0TDBOUVV6QUxCZ2xnaGtnQmh2MXNBUUl3CkNBWUdaNEVNQVFJQk1BZ0dCbWVCREFFQ0FqQUlCZ1puZ1F3QkFnTXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUIKQUFVa0hkMGJzQ3JybU5hRjR6bE5YbXRYbllKWC9Pdm9NYUpYa0dVRnZoWkVPRnAzQXJuUEVFTEc0WktrNDBVbgorQUJITEdpb1ZwbFRWSSt0bmtEQjBBKzIxdzBMT0Voc1VDeEprQVpiWkIyTHpFZ3dMdDRJNHB0SklzQ1NEQkZlCmxwS1UxZndnM0ZaczVaS1R2M29jd0RmamhVa1YraXZoZERrWUQ3ZmE4NkpYV0dCUHpJNlVBUHhHZXpReFBrMUgKZ29FNnkvU0pYUTd2VFExdW5CdUNKTjB5SlYwUmVGRVFQYUExSXdRdlpXK2N3ZEZEMTlBZTh6Rm5XU2ZkYTlKMQpDWk1SSkNRVXp5bSs1aVBEdUk5eVAra0h5Q1JFVTNxenVXRmxvVXdPeGtnQXlYVmpCWWR3UlZLRDA1V2RSZXJ3CjZERWRmZ2tmQ3Y0KzNhbzhYblRTckxFPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0t
    - op: replace
      path: /spec/provider/vault/server
      value: https://vault.swinney.io:443
